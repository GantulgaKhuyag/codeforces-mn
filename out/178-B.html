<h1 id="шуналтай-худалдаачид">Шуналтай худалдаачид</h1>
<p>Гайхамшигтай Ухаантай Минж ABBYY-д амьдардаг. Энэ удаа тэр түүх судалж эхэлжээ. Ромын эзэнт гүрний тухай уншсаны дараа тэр тухайн үеийн худалдаачдын амьдралын сонирхож эхлэв.</p>
<p>Ромын эзэнт гүрэн нийт <span class="math"><em>n</em></span> улсаас тогтдог, <span class="math">1</span>-ээс <span class="math"><em>n</em></span> хүртэл дугаарлая. Мөн <span class="math">1</span>-ээс <span class="math"><em>m</em></span> хүртэл дугаарлагдсан <span class="math"><em>m</em></span> ширхэг 2 чиглэлийн замтай. Зам бүр 2 өөр хотыг холбодог бөгөөд 2 хотыг холбосон ганц л зам байдаг.</p>
<p>Бид <span class="math"><em>c</em><sub>1</sub></span>, <span class="math"><em>c</em><sub>2</sub></span> хотын хооронд <span class="math"><em>t</em><sub>1</sub>, <em>t</em><sub>2</sub>, . . . , <em>t</em><sub><em>p</em></sub></span> (<span class="math"><em>p</em>≥1</span>) дараалал олдож байгаа тохиолдолд тэр 2 хотын хооронд зам байгаа гэж үзнэ. Үүнд:</p>
<ul>
<li><span class="math"><em>t</em><sub>1</sub></span> = <span class="math"><em>c</em><sub>1</sub></span></li>
<li><span class="math"><em>t</em><sub><em>p</em></sub></span> = <span class="math"><em>c</em><sub>2</sub></span></li>
<li>аль ч <span class="math"><em>i</em></span>-ын (<span class="math">1 ≤ <em>i</em> &lt; <em>p</em></span>) хувьд <span class="math"><em>t</em><sub><em>i</em></sub></span> болон <span class="math"><em>t</em><sub><em>i</em> + 1</sub></span> хотуудын хооронд зам байна</li>
</ul>
<p>Ромын эзэнт гүрний бүх хотууд хоорондоо холбоотой байна.</p>
<p>Эзэнт гүрэнд <span class="math"><em>k</em></span> худалдаачин байдаг ба тэднийг <span class="math">1</span>-ээс <span class="math"><em>k</em></span> хүртэл дугаарлая. Худалдаачин бүрийн агуулах <span class="math"><em>s</em><sub><em>i</em></sub></span> хотод байдаг ба дэлгүүр нь <span class="math"><em>l</em><sub><em>i</em></sub></span> hотод байдгыг бид мэдэж байгаа. Агуулах дэлгүүр хоёр нь өөр өөр хотод байж болох учир худалдаачин бараагаа агуулахаасаа дэлгүүр хүртэл зөөх хэрэгтэй болдог.</p>
<p>Хэрэв аливаа нэг замыг байхгүй тохиолдолд худалдаачин дэлгүүр лүүгээ очих боломжгүй болдог бол тухайн замыг <em>чухал</em> зам гэе. Ромын худалдаачид маш шуналтай учир тэд зөвхөн ашигласан чухал замынхаа төлбөрийг л төлдөг (<span class="math">1</span> динар). Хэрэв <span class="math"><em>i</em></span> дугаар худалдаачинд <span class="math"><em>d</em><sub><em>i</em></sub></span> (<span class="math"><em>d</em><sub><em>i</em></sub>≥0</span>) чухал зам байдаг гэж үзвэл тэр яг <span class="math"><em>d</em><sub><em>i</em></sub></span> динар төлөх юм.</p>
<p>Эзэнт гүрний татвар хураах өдөр болжээ. ABBYY-ийн Ухаантай Минж тэр өдөр худалдаачин бүр хэдэн динар төлөхийг мэдэхийг хүсэв. Түүнд тусална уу.</p>
<h3 id="оролт">Оролт</h3>
<p>Эхний мөрөнд нийт хотын тоог заах <span class="math"><em>n</em></span> тоо болон замуудын тоо болох <span class="math"><em>m</em></span> тоо өгөгдөнө. Дараагийн <span class="math"><em>m</em></span> мөрөнд <span class="math"><em>i</em></span> дахь зам <span class="math"><em>a</em><sub><em>i</em></sub></span> болон <span class="math"><em>b</em><sub><em>i</em></sub></span> (<span class="math">1 ≤ <em>a</em><sub><em>i</em></sub>, <em>b</em><sub><em>i</em></sub> ≤ <em>n</em></span>, <span class="math"><em>a</em><sub><em>i</em></sub> ≠ <em>b</em><sub><em>i</em></sub></span>), хотуудын холбосон гэж өгөгдөнө. Аль ч хоёр хотын хооронд зам байна гэхдээ 2 хотыг шууд холбосон ганц л зам байна.</p>
<p>Дараагийн мөрөнд хэдэн худалдаачин байгааг илэрхийлэх <span class="math"><em>k</em></span> тоо өгөгдөнө.</p>
<p>Үлдсэн <span class="math"><em>k</em></span> мөрөнд <span class="math"><em>i</em></span> дугаар худалдаачны агуулахын байрлал <span class="math"><em>s</em><sub><em>i</em></sub></span> болон дэлгүүрийн байрлал <span class="math"><em>l</em><sub><em>i</em></sub></span> (<span class="math">1 ≤ <em>s</em><sub><em>i</em></sub>, <em>l</em><sub><em>i</em></sub> ≤ <em>n</em></span>) хоёр тоо зайгаар тусгаарлагдан өгөгдөнө.</p>
<p><span class="math">20</span> оноо авах хязгаарлалтууд:</p>
<ul>
<li><span class="math">1 ≤ <em>n</em> ≤ 200</span></li>
<li><span class="math">1 ≤ <em>m</em> ≤ 200</span></li>
<li><span class="math">1 ≤ <em>k</em> ≤ 200</span></li>
</ul>
<p><span class="math">50</span> оноо авах хязгаарлалтууд:</p>
<ul>
<li><span class="math">1 ≤ <em>n</em> ≤ 2000</span></li>
<li><span class="math">1 ≤ <em>m</em> ≤ 2000</span></li>
<li><span class="math">1 ≤ <em>k</em> ≤ 2000</span></li>
</ul>
<p><span class="math">100</span> оноо авах хязгаарлалтууд:</p>
<ul>
<li><span class="math">1 ≤ <em>n</em> ≤ 10<sup>5</sup></span></li>
<li><span class="math">1 ≤ <em>m</em> ≤ 10<sup>5</sup></span></li>
<li><span class="math">1 ≤ <em>k</em> ≤ 10<sup>5</sup></span></li>
</ul>
<h3 id="гаралт">Гаралт</h3>
<p>Яг <span class="math"><em>k</em></span> мөр хэвлэнэ. <span class="math"><em>i</em></span> дахь мөр нь <span class="math"><em>i</em></span> дахь худалдаачны тэр өдөр хэдэн динар төлсныг агуулана.</p>
<p>C++ хэл дээр 64-битийн тоо хэрэглэх үед %lld-г хэрэглэхгүй байхыг зөвлөж байна. %I64d эсвэл cin, cout стриймийг ашиглана уу.</p>

<p class="math" style="text-align:right;font-style:italic">Орчуулсан: Энхсанаа</p>