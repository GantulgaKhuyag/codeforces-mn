<h1 id="дима-болон-шидэт-гитар">Дима болон шидэт гитар</h1>
<p>Дима Иннад маш их хайртай. Тэр бүсгүйдээ дуу бичихээр шийджээ. Димад <span class="math"><em>n</em></span> утастай <span class="math"><em>m</em></span> ладтай шидэт гитар байдаг. Дима гитараараа ая тоглохын тулд утаснуудын нэгийг ладнуудын нэг дээр дарж утсыг татдаг. Дима <span class="math"><em>i</em></span> дэх утсыг <span class="math"><em>j</em></span> дэх ладан дээр дарж байгаад утсыг татвал дугарах нотыг <span class="math"><em>a</em><sub><em>i</em><em>j</em></sub></span> гэж тэмдэглэе. Бид Димагийн гитарыг <span class="math"><em>k</em></span> ширхэг ялгаатай нот дугаргаж чадахыг мэддэг. Зарим нотнууд хэд хэдэн янзаар тоглогдох боломжтой юм. Өөрөөр хэлбэл (<span class="math"><em>i</em>, <em>j</em></span>) <span class="math"> ≠ </span> (<span class="math"><em>p</em>, <em>q</em></span>) үед <span class="math"><em>a</em><sub><em>i</em><em>j</em></sub> = <em>a</em><sub><em>p</em><em>q</em></sub></span> байх боломжтой.</p>
<p>Дима <span class="math"><em>s</em></span> ширхэг нотны дарааллаас бүтсэн дуугаа аль хэдийн бичсэн байна. Дууг тоглохын тулд та гитараар дууны нотнуудыг дараалуулан тоглох хэрэгтэй. Та нот бүрийг дурын боломжит хувилбараар тоглож болно. Дима дууг тоглох олон хувилбар байгааг ойлгосон бөгөөд тэрээр дуугаа аль болох ярвигтай харагдах байдлаар тоглохыг хүсчээ (Кобэйн шиг царайлахыг хичээнэ).</p>
<p>Бид дууг тоглох хувилбарыг (<span class="math"><em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub></span>) (<span class="math">1 ≤ <em>i</em> ≤ <em>s</em></span>) хосуудаар илэрхийлэх бөгөөд <span class="math"><em>y</em><sub><em>i</em></sub></span> дүгээр ладан дээрхи <span class="math"><em>x</em><sub><em>i</em></sub></span> дүгээр утас дууны <span class="math"><em>i</em></span> дэх нотыг тоглоно. (<span class="math"><em>x</em><sub>1</sub>, <em>y</em><sub>1</sub></span>) ба (<span class="math"><em>x</em><sub>2</sub>, <em>y</em><sub>2</sub></span>) хосуудын хоорондох ярвигтай байдлын хэмжээ <img src="http://codeforces.com/problemset/problem/366/E" />+<img src="http://codeforces.com/problemset/problem/366/E" />-тэй тэнцэнэ. Дууг тоглох хувилбарын ярвигтай байдлын хэмжээ нь зэргэлдээ нотуудын хооронд шилжих үйлдлийн ярвигтай байдлуудын хамгийн их утга юм.</p>
<p>Димад энэ дууг тоглох хамгийн ярвигтай замыг тодорхойлоход туслаарай! Залуу янзтай харагдах хэрэгтэй байна шүү дээ!</p>
<h3 id="оролт">Оролт</h3>
<p>Оролтын хамгийн эхний мөр <span class="math"><em>n</em></span>, <span class="math"><em>m</em></span>, <span class="math"><em>k</em></span> ба <span class="math"><em>s</em></span> (<span class="math">1 ≤ <em>n</em>, <em>m</em> ≤ 2000</span>, <span class="math">1 ≤ <em>k</em> ≤ 9</span>, <span class="math">2 ≤ <em>s</em> ≤ 10<sup>5</sup></span>) гэсэн 4 бүхэл тоо агуулна.</p>
<p>Дараагийн <span class="math"><em>n</em></span> мөрүүд тус бүр <span class="math"><em>m</em></span> ширхэг <span class="math"><em>a</em><sub><em>i</em><em>j</em></sub></span> (<span class="math">1 ≤ <em>a</em><sub><em>i</em><em>j</em></sub> ≤ <em>k</em></span>) бүхэл тоонуудаг агуулна. <span class="math"><em>i</em></span> дүгээр мөр <span class="math"><em>j</em></span> дүгээр багана дахь тоо (<span class="math"><em>a</em><sub><em>i</em><em>j</em></sub></span>) нь гитар <span class="math"><em>i</em></span> дүгээр утас <span class="math"><em>j</em></span> дүгээр ладан дээр дугарч байгаа нотыг илэрхийлж байгаа юм.</p>
<p>Оролтын сүүлийн мөр дууны нотнуудын дараалал болох <span class="math"><em>s</em></span> ширхэг <span class="math"><em>q</em><sub><em>i</em></sub></span> (<span class="math">1 ≤ <em>q</em><sub><em>i</em></sub> ≤ <em>k</em></span>) бүхэл тоонуудыг агуулна.</p>
<h3 id="гаралт">Гаралт</h3>
<p>Дууг тоглох ярвигтай байдлийн хамгийн их боломжит утга болох ганц тоог ганц мөрөнд хэвлэнэ.</p>

<p class="math" style="text-align:right;font-style:italic">Орчуулсан: Энхдүүрэн</p>