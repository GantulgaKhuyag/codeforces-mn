<h1 id="хамгийн-богино-зам">Хамгийн богино зам</h1>
<p>Эртний Бэрланд <span class="math"><em>n</em></span> хоттой, ижил урттай, хоёр урсгалтай <span class="math"><em>m</em></span> замтай байв. Хотууд <span class="math">1</span>-ээс <span class="math"><em>n</em></span> хүртэл дугаарлагдсан. Эртний мухар сүсгийн дагуу хэрвээ аялагч дунд нь өөр хотоор дайралгүй <span class="math"><em>a</em><sub><em>i</em></sub></span>, <span class="math"><em>b</em><sub><em>i</em></sub></span>, <span class="math"><em>c</em><sub><em>i</em></sub></span> хотуудаар дараалан өнгөрвөл үнэхээр аймшигтай зүйл түүнийг хүлээж байдаг гэлцдэг.</p>
<p>Хотод нийт <span class="math"><em>k</em></span> ширхэг ийм гурвал байдаг. Гурвал бүр яг дарааллаараа өгөгднө, энэ нь жишээлбэл та <span class="math"><em>a</em><sub><em>i</em></sub></span>, <span class="math"><em>c</em><sub><em>i</em></sub></span>, <span class="math"><em>b</em><sub><em>i</em></sub></span> гэсэн дарааллаар аялах боломжтой. Вася <span class="math">1</span> хотоос <span class="math"><em>n</em></span> хот руу тэр мухар сүсгийг зөрчилгүйгээр явахыг хүсэв. Түүний туулах хамгийн богино замын уртыг олно уу. Бас ямар маршрутаар явахыг нь зааж өгнө үү.</p>
<h3 id="оролт">Оролт</h3>
<p>Эхний мөр харгалзан хотын тоо, замын тоо, хориотой гурвалын тоо болох <span class="math"><em>n</em></span>, <span class="math"><em>m</em></span>, <span class="math"><em>k</em></span> (<span class="math">2 ≤ <em>n</em> ≤ 3000</span>, <span class="math">1 ≤ <em>m</em> ≤ 20000</span>, <span class="math">0 ≤ <em>k</em> ≤ 10<sup>5</sup></span>) гурван бүхэл тоог агуулна.</p>
<p>Дараагийн <span class="math"><em>m</em></span> мөрөнд мөр бүрт замыг илэрхийлэх <span class="math"><em>x</em><sub><em>i</em></sub></span>, <span class="math"><em>y</em><sub><em>i</em></sub></span> (<span class="math">1 ≤ <em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub> ≤ <em>n</em></span>) хоёр бүхэл тоог агуулна. Зам нь уг замаар холбогдсон хоёр хотоор тодорхойлогдно. Хот өөртэйгөө замаар холбогдохгүй ба хос хотын хооронд нэгээс олон зам байж болохгүй.</p>
<p>Дараагийн <span class="math"><em>k</em></span> мөрөнд хориотой гурвалууд болох <span class="math"><em>a</em><sub><em>i</em></sub></span>, <span class="math"><em>b</em><sub><em>i</em></sub></span>, <span class="math"><em>c</em><sub><em>i</em></sub></span> (<span class="math">1 ≤ <em>a</em><sub><em>i</em></sub>, <em>b</em><sub><em>i</em></sub>, <em>c</em><sub><em>i</em></sub> ≤ <em>n</em></span>) гурван бүхэл тоо өгөгднө. Гурвал бүр энэ жагсаалтад нэгээс олон удаа байхгүй. Гурвал дахь гурван хот хоорондоо ялгаатай.</p>
<p><span class="math">1</span>-ээс <span class="math"><em>n</em></span> хот руу замаар холбогдох боломжгүй байж болно.</p>
<h3 id="гаралт">Гаралт</h3>
<p><span class="math">1</span>-ээс <span class="math"><em>n</em></span> рүү явах зам байхгүй бол <span class="math"> − 1</span> гэж хэвлэ. Бусад тохиолдолд эхний мөрөнд <span class="math">1</span>-ээс <span class="math"><em>n</em></span> хот руу очих хамгийн богино замын урт болох <span class="math"><em>d</em></span> тоог хэвлэнэ. Хоёрдахь мөрөнд Васягийн явах ямар нэгэн хамгийн богино замыг илэрхийлэх <span class="math"><em>d</em> + 1</span> ширхэг бүхэл тоог хэвлэ. Энэ зам <span class="math">1</span> хотоос эхлэн <span class="math"><em>n</em></span> хот дээр төгсөх ёстой.</p>
<p class="credit" style="text-align:right;font-style:italic">Орчуулсан: Sugardorj</p>