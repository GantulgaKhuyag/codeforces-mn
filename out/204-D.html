<h1 id="жижигхэн-заан-ба-ретро-тэмдэгт-мөр">Жижигхэн заан ба Ретро тэмдэгт мөр</h1>
<p>Жижигхэн заан дээврийнхээ хөндийгөөс хуучирч хаягдсан хар цагаан тэмдэгт мөр олжээ.</p>
<p>Тэмдэгт мөрийн элементүүд нь зүүнээс баруун тийш <span class="math">1</span>-с <span class="math">∣<em>s</em>∣</span> хүртэл дугаарладсан. Энд <span class="math">∣<em>s</em>∣</span> нь тэмдэгт мөрийн урт болно. Тэмдэгт мөрийн <span class="math"><em>i</em></span>-р элементийг <span class="math"><em>s</em><sub><em>i</em></sub></span> гэж үзье. Энэ тэмдэгт мөр нь зөвхөн хар, эсвэл цагаан л элементтэй тул <span class="math"><em>s</em><sub><em>i</em></sub></span> бүр нь &quot;B&quot; эсвэл &quot;W&quot; байх ёстой. Харамсалтай нь энэ тэмдэгт мөр нэлээн хуучин тул зарим элемент нь мэдэгдэхгүй болчихсон бөгөөд тэдгээрийг &quot;X&quot; гэж тэмдэглэсэн.</p>
<p>Жижигхэн заан маань энэ тэмдэгт мөрийг сэргээж, ханандаа өлгөхийг хүсчээ. Мэдээж хананд өлгөхийн тулд <span class="math"><em>s</em></span> тэмдэгт мөр &quot;үзэсгэлэнтэй&quot; байх ёстой. Тэр &quot;үзэсгэлэнтэй&quot; тэмдэгт мөр нь заавал <span class="math"><em>k</em></span> урттай, зүүн талынх нь зөвхөн &quot;B&quot;, баруун талынх нь зөвхөн &quot;W&quot; агуулсан байх хоорондоо давхцаагүй 2 дэд тэмдэгт мөр олддог байх ёстой гэж тодорхойлж ээ. Өөрөөр хэлвэл (<span class="math">1 ≤ <em>a</em> ≤ <em>b</em> &lt; <em>c</em> ≤ <em>d</em> ≤ ∣<em>s</em>∣</span>; <span class="math"><em>b</em> − <em>a</em> + 1 = <em>d</em> − <em>c</em> + 1 = <em>k</em></span>) байх <span class="math"><em>s</em><sub><em>i</em></sub></span> = &quot;B&quot; (<span class="math"><em>a</em> ≤ <em>i</em> ≤ <em>b</em></span>) and <span class="math"><em>s</em><sub><em>j</em></sub></span> = &quot;W&quot; (<span class="math"><em>c</em> ≤ <em>j</em> ≤ <em>d</em></span>) нөхцлийг хангах <span class="math"><em>a</em></span>, <span class="math"><em>b</em></span>, <span class="math"><em>c</em></span>, <span class="math"><em>d</em></span> тоо олддог байх ёстой юм.</p>
<p>Жижигхэн заан маань <span class="math"><em>s</em></span> тэмдэгт мөрийг хэдэн ялгаатай янзаар өөрчилж болохоо мэдэхийг хүсчээ. Хэрвээ үүссэн 2 тэмдэгт мөрд аль нэг элемент нь ялгаатай байвал тэр 2-г ялгаатай гэж үзнэ. Хэрвээ анхны тэмдэгт мөр &quot;X&quot; агуулаагүй бөгөөд, аль хэдийнээ &quot;үзэсгэлэнтэй&quot; байвал <span class="math">1</span> гэж хэвлээрэй.</p>
<p>Хариу маш том байж болох тул <span class="math">1000000007</span> (<span class="math">10<sup>9</sup> + 7</span>)-д хуваасны үлдэгдлийг хэвлээрэй.</p>
<h3 id="оролт">Оролт</h3>
<p>Оролтын эхний мөрөнд <span class="math"><em>n</em></span>, <span class="math"><em>k</em></span> <span class="math">1 ≤ <em>k</em> ≤ <em>n</em> ≤ 10<sup>6</sup></span> өгөгдөнө. Хоёрдугаар мөрөнд <span class="math"><em>s</em></span> тэмдэгт мөр байна. <span class="math"><em>s</em></span> тэмдэгт мөрийн урт нь <span class="math"><em>n</em></span> байх бөгөөд зөвхөн &quot;B&quot;, &quot;W&quot;, &quot;X&quot; тэмдэгтүүдээс тогтоно.</p>
<h3 id="гаралт">Гаралт</h3>
<p>Бодлогын хариуг <span class="math">1000000007</span> (<span class="math">10<sup>9</sup> + 7</span>)-д хуваахад гарах үлдэгдэл ганц тоо хэвлэнэ.</p>
