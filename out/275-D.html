<h1 id="тэг-мод">Тэг мод</h1>
<p>Мод бол <span class="math"><em>n</em></span> оройтой, яг <span class="math"><em>n</em> − 1</span> ирмэгээр холбогдсон, дурын 2 оройн хооронд хамгийн богино зам цор ганц байдаг граф юм.</p>
<p><span class="math"><em>T</em></span> модны дэд мод гэдэг нь <span class="math"><em>T</em></span> модны орой болон ирмэгийн дэд олонлогоос тогтсон мод байна.</p>
<p>Танд <span class="math"><em>n</em></span> оройтой мод өгөгдсөн. Оройнууд нь <span class="math">1</span>-ээс <span class="math"><em>n</em></span> хүртэл дугаардагдсан. Мөн орой бүр дээр нэг нэг тоо бичигдсэн байгаа. Эхэндээ <span class="math"><em>i</em></span>-дэх орой дээр бичигдсэн тоо нь <span class="math"><em>v</em><sub><em>i</em></sub></span> байсан. Нэг ээлжин дээр дараах үйлдлүүдийг хийж чадна.</p>
<ol style="list-style-type: decimal">
<li>Өгөгдсөн модноос дээрх тоо нь <span class="math">1</span> байх орой агуулсан дэд мод сонгон авна.</li>
<li>Сонгосон дэд модон агуулагдаж байгаа бүх тоог <span class="math">1</span>-ээр ихэсгэнэ нэг бол багасгана.</li>
</ol>
<p>Өгөгдсөн модны бүх орой дээрх тоог <span class="math">0</span> болгох хамгийн цөөн үйлдлийн тоог ол.</p>
<h3 id="оролт">Оролт</h3>
<p>Эхний мөрөнд оройн тоо <span class="math">$n(1\leqn\leq10^5)$</span>. Дараагийн <span class="math"><em>n</em> − 1</span> мөрөнд хоорондоо холбогдсон хоёр оройн дугаар <span class="math">$a_i,\ b_i(1\leqa_i,b_i\leqn;\ a_i\neqb_i)$</span> байрлана. Оролтонд баталгаатай мод өгөгдөнө.</p>
<p>Сүүлйин мөрөнд оройнууд дээр байрлах тоо <span class="math"><em>v</em><sub>1</sub>,  <em>v</em><sub>2</sub>, . . . ,  <em>v</em><sub><em>n</em></sub>(∣<em>v</em><sub><em>i</em></sub>∣ ≤ 10<sup>9</sup>)</span> агуулагдана.</p>
<h3 id="гаралт">Гаралт</h3>
<p>Бодлогыг шийдэж болох хамгийн бага үйлдлийн тоог хэвлэнэ.</p>
<p>C++ хэл дээр 64-битийн тоо хэрэглэх үед %lld-г хэрэглэхгүй байхыг зөвлөж байна. %I64d, эсвэл cin, cout стриймийг ашиглана уу.</p>
<p class="credit" style="text-align:right;font-style:italic">Орчуулсан: Говьхүү</p>